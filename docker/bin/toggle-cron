#!/usr/bin/env bash

# Toggles the cron container.

set -e

cd "$( dirname "${BASH_SOURCE[0]}" )"
cd ../..

. ./docker/bin/deps/utils.sh

if [ ! -f ".env" ]; then
    echo "${RED}The file .env does not exist.${RESET}"
    exit 1
fi

. ./.env

if [ "$CRON_COMMAND" = "true" ]; then
    VALUE="run-command"
    STATUS="enabled"
else
    VALUE="true"
    STATUS="disabled"
fi

sed -i "s/^CRON_COMMAND=.*/CRON_COMMAND=$VALUE/" .env
echo "${GREEN}CRON_COMMAND was set to \"$VALUE\" ($STATUS).${RESET}"

$($DOCKER_COMPOSE up -d --no-deps "$CRON_CONTAINER")
